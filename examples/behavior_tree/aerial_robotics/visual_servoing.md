## The primitive prompts provided by engineers:
```
Now imagine you are a fully autonomous drone in gazebo simulator.
The simulator contains a drone and a target object. And the object will be in the fov when drone takeoff.
The position of drone and target object in 3D environment is denoted as [drone_x, drone_y, drone_z] and [object_x, object_y, object_z].

There is a forward-facing camera mounted in front of you. 
This camera can continuously sense the image with RGB. It is available for the camera to sense the outside environment.
There are two subtrees about sensing, you can also consider it when design behavior tree:
"object_in_view": This behavior tree will return true when there is desired object in sight. 
"object_not_in_view": This behavior tree will return true when there is no object in sight.

The following subtrees are available. You are not allowed to use any other hypothetical functions. And not all subtrees are suitable and necessary, you need to evaluate and choose the subtrees you need.
Subtrees:
"reset_drone": When this subtree is triggered, reset the preflight state that need to reset before takeoff.
"waypoint_takeoff": When this subtree is triggered, takeoff to the air.
"waypoint_landing": When this subtree is triggered, land to the ground immediately.
"waypoint_tracking": When this subtree is triggered, move toward the target object position when the target object is inside the camera view.
"linear_x_control": When this subtree is triggered, try to minimize the absolute(drone_x - object_x) when the target object is inside the camera view.
"linear_y_control": When this subtree is triggered, try to minimize the absolute(drone_y - object_y) when the target object is inside the camera view.
"linear_z_control": When this subtree is triggered, try to minimize the absolute(drone_z - object_z) when the target object is inside the camera view.
"report_error": When this subtree is triggered, report current distance (distance = (drone_x - object_x)^2 + (drone_y - object_y)^2 + (drone_z - object_z)^2)^0.5) , and the supervisor will evaulate the performance according to this distance.
"explore_forward": When this subtree is triggered, move forward a static distance one time and raise the flag. If the flag is not been reset, this subtree will not been triggered.
"explore_left_and_right": When this subtree is triggered, rotate to left side and right side one time and raise the flag. If the flag is not been reset, this subtree will not been triggered.
"explore_patter_block": When this subtree is triggered, follow the pattern block pattern to explore a huge area.


And here are the example source tasks in behavior tree architecture:

Task: change wheel for a car

Procedure:
    Do phase 1:{
        Do phase 1-1:{
            "put_car_at_conveyor"
        }Do phase 1-2 if 1-1 success:{
            "lift_car"
        }
    }Do phase 2 if 1 success:{
        Do phase 2-1:{
            "pick_wheel"
        }Do phase 2-2 if 2-1 success:{
            "approach_conveyor"
        }
    }Do phase 3 if 2 success:{
        Do phase 3-1 at the same time:{
            "align_wheel_in_x_axis"
            "align_wheel_in_y_axis"
        }
    }Do phase 4 if 3 success:{
        Do phase 4-1:{
            "insert_screws"
        }Do phase 4-2 if 4-1 success:{
            "fasten_screws"
        }
    }Do phase 5 if 4 success:{
        Do phase 5-1:{
            "leave_conveyor"
        }
    }


Task: Take off and fly to the desired destination. After reach the destination, go home.

Procedure:
    Do phase 1:{
        Do phase 1-1:{
            "already_visited_destination"
        }Do phase 1-2 if 1-1 success:{
            "already_at_home"
        }Do phase 1-3 if 1-2 success:{
            "land"
        }
    }Do phase 2 if 1 failed:{
        Do phase 2-1:{
            Do phase 2-1-1:{
                "already_in_the_air"
            }Do phase 2-1-2 if 2-1-1 success:{
                "takeoff"
            }
        }Do phase 2-2 if 2-1 success:{
            Do phase 2-2-1:{
                "already_visited_destination"
            }Do phase 2-2-2 if 2-2-1 success:{
                "go_to_destination"
            }
        }Do phase 2-3 if 2-2 success:{
            Do phase 2-3-1:{
                "already_at_home"
            }Do phase 2-3-2 if 2-3-1 success:{
                "go_home"
            }
        }
    } 
```

## The variant prompt provided by non-techinal users:
```
Now you need to keep the object in view when you see it. 
Please design a behavior tree for this task, and you must follow the format of source task.
```
## The behavior tree generated by LLM:

```
Procedure:
    Do phase 1:{
        Do phase 1-1:{
            "object_in_view"
        }Do phase 1-2 if 1-1 success:{
            Do phase 1-2-1 at the same time{
                "linear_x_control"
                "linear_y_control"
                "linear_z_control"
            }
        }
    }Do phase 2 if 1 failed:{
        Do phase 2-1:{
            "reset_drone"
        }Do phase 2-2 if 2-1 success:{
            "waypoint_takeoff"
        }Do phase 2-3 if 2-2 success:{
            "explore_pattern_block" 
        } 
    }
```

## The behavior tree after post-processing parsing:
```
?
    ->
        (object_in_view)
        ||
            ?
                (linear_x_in_margin)
                [linear_x_control]
            ?
                (linear_y_in_margin)
                [linear_y_control]
            ?
                (linear_z_in_margin)
                [linear_z_control]
    ->
        ?
            (state_offboard)
            ->
                ?
                    <!>
                        (waypoint_takeoff_finished)
                    [waypoint_takeoff_reset]
        ->
            (state_offboard)
            ?
                (waypoint_takeoff_finished)
                [waypoint_takeoff]
        ->
            ?
                (explore_pattern_block_finished)
            [explore_pattern_block]
```
## Visualize in graphical user interface:
![](/examples/figs/bt_visual_servoing.png)

## Video:
[watch demo video](http://gofile.me/773h8/ZKdv0ROEI)